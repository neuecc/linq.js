<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>linq.js test:Aggregate</title>
    <script type="text/javascript" src="../jsunit/app/jsUnitCore.js"></script>
    <script type="text/javascript" src="../linq.js"></script>
</head>
<body>
    <!-- This file is linq.js test for JsUnit -->
    <script type="text/javascript">
        var E = Enumerable;
        var result;
        var correct;

        function testAggregate()
        {
            result = E.Range(1, 10).Aggregate("a,b=>a+b");
            correct = 55;
            assertEquals(correct, result);
        }

        function testAggregate2()
        {
            result = E.Range(1, 10).Aggregate(10, "a,b=>a+b");
            correct = 65;
            assertEquals(correct, result);
        }

        function testAggregate3()
        {
            result = E.Range(1, 10).Aggregate(10, "a,b=>a+b", "val=>val*10");
            correct = 650;
            assertEquals(correct, result);
        }

        function testAverage()
        {
            result = E.Range(1, 10).Average();
            correct = 5.5;
            assertEquals(correct, result);
        }

        function testAverage2()
        {
            result = E.Range(1, 10).Select("v,i=>{v:v,i:i}").Average("t=>t.i");
            correct = 4.5;
            assertEquals(correct, result);
        }

        function testCount()
        {
            result = E.Range(1, 10).Count();
            correct = 10;
            assertEquals(correct, result);
        }

        function testCount2()
        {
            result = E.Range(1, 10).Count("i=>i<5");
            correct = 4;
            assertEquals(correct, result);
        }

        function testMax()
        {
            result = E.Range(1, 10).Max();
            correct = 10;
            assertEquals(correct, result);
        }

        function testMax2()
        {
            result = E.Range(1, 10).Select("v,i=>{v:v,i:i}").Max("t=>t.i");
            correct = 9;
            assertEquals(correct, result);
        }

        function testMin()
        {
            result = E.Range(1, 10).Min();
            correct = 1;
            assertEquals(correct, result);
        }

        function testMin2()
        {
            result = E.Range(1, 10).Select("v,i=>{v:v,i:i}").Min("t=>t.i");
            correct = 0;
            assertEquals(correct, result);
        }

        function testMaxBy()
        {
            result = E.Range(1, 10).Select("v,i=>{v:v,i:i}").MaxBy("t=>t.i");
            correct = { v: 10, i: 9 };
            assertObjectEquals(correct, result);
        }

        function testMinBy()
        {
            result = E.Range(1, 10).Select("v,i=>{v:v,i:i}").MinBy("t=>t.i");
            correct = { v: 1, i: 0 };
            assertObjectEquals(correct, result);
        }

        function testSum()
        {
            result = E.Range(1, 10).Sum();
            correct = 55;
            assertEquals(correct, result);
        }

        function testSum2()
        {
            result = E.Range(1, 10).Select("v,i=>{v:v,i:i}").Sum("t=>t.i");
            correct = 45;
            assertEquals(correct, result);
        }
    </script>
</body>
</html>
